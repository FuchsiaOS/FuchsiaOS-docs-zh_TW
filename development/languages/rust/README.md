# Rust

## Targets

There are two GN targets which should be used for Rust projects:
- [`rustc_library`][target-library-rustc] defines a library which can be used
  by other targets.
- [`rustc_binary`][target-binary-rustc] defines an executable.

The [garnet/examples/rust][rust-examples] directory has some examples of Rust
packages that use these targets, as do the [Rust FIDL examples][fidl-tutorial].

These GN targets do not require a `Cargo.toml` file, as they are not built with
Cargo during a normal build of Fuchsia. However, a `Cargo.toml` file can be
created for these targets by running
`fx gen-cargo path/from/fuchsia/root/to/target:label`. In order to generate a
Cargo.toml, there must have first been a successful build of Fuchsia which
included the target. Generating `Cargo.toml` files is useful for integration with
IDEs such as Intellij and VSCode, and for using the [`fargo`][fargo] tool to build
and test targets without going through a full GN build and run cycle each time.

You can also run unit tests on connected devices using `fx`, with the
`fx run-test {package name}_{bin or lib}_test_rustc` command, assuming your
package in `BUILD.gn` has `with_unit_tests = true`.

## Style

We don't currently have a style guide for Rust, but you should
run [`rustfmt`][rustfmt-install] before submitting. We mostly use the rustfmt
defaults, but have a couple [custom settings][rustfmt-toml].

## Building With a Custom Toolchain

If you want to test out Fuchsia with your own custom-built versions of rustc or cargo,
you can set the `rustc_prefix` argument to `fx set`, like this:

```
fx set x64 --release --args "rustc_prefix=\"/path/to/bin/dir\""
```

## Communication Channels

Public discussion happens on the [rust@fuchsia.com] mailing list.
For Googler-only channels, see [go/fuchsia-rust-googlers].

## Existing Fuchsia Rust Libraries

- [List of crates](crates.md)
- [Autogenerated documentation for crates](https://fuchsia-docs.firebaseapp.com)

## Going further

- [Editor setup](editors.md)
- [Managing third-party dependencies](third_party.md)
- [Unsafe code](unsafe.md)
- [Unstable features](unstable.md)
- [Rust FIDL server/client tutorial][fidl-tutorial]
- [Syslog API](syslog.md)

[target-library-rustc]: https://fuchsia.googlesource.com/build/+/master/rust/rustc_library.gni "Rust library"
[target-binary-rustc]: https://fuchsia.googlesource.com/build/+/master/rust/rustc_binary.gni "Rust binary"
[rust-examples]: https://fuchsia.googlesource.com/garnet/+/master/examples/rust/
[fargo]: https://fuchsia.googlesource.com/fargo
[rustfmt-install]: https://github.com/rust-lang-nursery/rustfmt#quick-start
[rustfmt-toml]: https://fuchsia.googlesource.com/garnet/+/master/rustfmt.toml
[fidl-tutorial]: https://fuchsia.googlesource.com/docs/+/HEAD/development/languages/fidl/tutorial/README.md#server-in-rust
[rust@fuchsia.com]: https://groups.google.com/a/fuchsia.com/forum/#!forum/rust-fuchsia
[go/fuchsia-rust-googlers]: https://goto.google.com/fuchsia-rust-googlers
